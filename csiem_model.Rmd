# CSIEM : model

<br>

## Overview

The following sections describe the model platform and detail the CSIEM configuration. More detailed scientific descriptions of the model setup and performance are summarised in Chapters 6 - 10.

##	Water quality model : TUFLOW-FV – AED 

The base model used in the CSIEM platform is the finite volume hydrodynamic model TUFLOW-FV, developed by BMT Global Pty Ltd (BMTWBM, 2023). The model adopts a flexible-mesh and accounts for variations in water level, salinity, temperature, and density in response to tides, inflows and surface thermodynamics. At the ocean-side (western) boundary the model is driven by conditions predicted by the regional ROMS model (see Section 2.4).  At the surface, the model is driven by spatially-variable outputs from various weather data-sets. The model includes additional enhanced useability features including integration with QGIS, optimisation for operation on GPUs, multiple turbulence closure and numerical schemes, and ability for including a wide array of industry-relevant boundary conditions (e.g., for resolving aspects such as dredging, discharges and coastal infrastructure). The model has been widely validated in a range of coastal areas around Australia.

To simulate the water quality and benthic habitat aspects, the AED water quality model is linked with TUFLOW-FV. AED is a community-driven library of modules and algorithms for simulation of “aquatic eco-dynamics” - water quality, aquatic biogeochemistry, biotic habitat and aquatic ecosystem dynamics, developed by the Centre for Water and Spatial Science at UWA (Hipsey et al., 2022). Each module has options for resolving key aquatic processes sourced from a wide variety of scientific literature, making the library one of the most advanced available to aquatic ecosystem modellers. In subsequent chapters, several bespoke modifications made to AED modules for simulations of Cockburn Sound are outlined.

A summary of the included variables that are simulated by the coupled platform is presented in Table 4.1. These are described in more detail in Chapters 10 and 11.

##	Model simulation domain

The geographical extent of the CSIEM domain is centred around Cockburn Sound, extending from Mandurah at the south to Quinns Rocks at the north (32.677°S – 31.669°S), and from outer Rottnest Island at the west to Narrows Bridge at the east (115.323°E - 115.858°E) (Figure 2.2). The model adopted a ﬂexible-mesh (ﬁnite-volume) approach, in which the mesh consists of triangular and quadrilateral elements of different sizes that are suited to simulating areas of complex morphometry, with the model resolution generally increases from the offshore areas to the nearshore areas. 

The model domain bathymetry was derived from a 10m DEM product and a range of other data sources (Gunaratne et al., 2023). The vertical mesh discretization adopted a hybrid σ-z coordinate allowing multiple surface Lagrangian layers to respond to tidal elevation changes. The layer thickness was 0.5 m at depths of 3.0–4.0 m, 1.0 m at depths of 4.0-23.0 m, that gradually increased to 50 m in deeper water, and then four uniformly distributed sigma layers were added above the ﬁxed thickness layers. 

There are three mesh options (namely coarse, optimised, and fine resolutions) available to support different research and management needs. The mesh structures can be seen in Figure 2.2, corresponding benthic material zones in Figure 2.4, and summary of cell numbers and sizes in Table 2.1. The fine- and coarse-mesh models share the same boundary conditions and have been bench-marked with each other. This is an advanced feature of CSIEM modelling platform.  Users can choose a mesh option that is suitable to their needs depending on the resolution and run time requirements, where different meshes can be used in different stages of model development. When modellers use the MARVL platform for visualisations and analysis of results (Hipsey et al. 2025), then plotting and assessment works in an identical way regardless of the chosen mesh, and simulations on different mesh resolutions can be compared.

![](./media/model/image4.png){width="95%"}

**Figure 4.1.** Plan-view of CSIEM model mesh around the Cockburn Sound region in A (coarse), B (optimized), C (fine) options.


## Boundary conditions

Regardless of the model mesh option that is chosen, the CSIEM system manages several standard boundary conditions to allow the model to be forced by tidal, meteorological and inflow information, which is brought together from various data sources (Figure 4.2). 

The CSIEM boundary conditions include:   

•	Meteorology: Meteorological conditions are collected from a range of sources. For the years before 2019, the spatially resolved Bureau of Meteorology Atmospheric High-Resolution Regional Reanalysis for Australia (BARRA) climate model is used. Beyond 2019. The BARRA-PH 1.5km resolution product is discontinued, and the Weather Research and Forecasting (WRF) product is used instead. 

•	Wave conditions: Set on the surface of model domain, the wave conditions (significant wave heights, periods, directions) are specified based on the integration of the WWMSP WWM outputs, or BMT's SWAN outputs.

•	Ocean physical conditions: Set on the ocean side, an open boundary is specified based on the integration with WWMSP ROMS modelling outputs. Water level, velocity, water temperature and salinity are specified along the boundary extent.  

•	Ocean biogeochemical conditions: In addition to the variables needed for CSIEM hydrodynamic predictions, numerous water quality variables are specified using a ‘monthly climatology’ approach that is described in detail in Chapter 6. 

•	Swan-Canning and Peel-Harvey inflows: Inflows to the CSIEM model domain from the local catchment via Swan-Canning River and Peel-Harvey Estuary was set based on available flow data from Water Information Reporting (WIR) portal (https://wir.water.wa.gov.au/Pages/Water-Information-Reporting.aspx). The nutrient boundary condition inputs are extrapolated based on field measurements at the nearest sites to the model boundaries.

•	Groundwater inputs: Set at the sediment-water interface of Cockburn Sound, the groundwater fluxes and its associated nutrient loads are specified based on the integration of the Theme 3.3 groundwater model outputs. More details of linkage between the groundwater inputs and CSIEM are provided in Chapter 8. 

•	Wastewater treatment plants (WWTPs) inputs: The discharge rates of the WWTPs and their water quality were obtained from the National Outfall Database (https://nod.org.au/), which included data of Alkimos, Beenyup, East Rockingham, Point Peron, Subiaco, and Woodman Point from Jan/2015 to Jun/2021 at monthly intervals. Outside the reporting period, mean values of water quality in the corresponding months were used. More details of linkage between the groundwater inputs and CSIEM are provided in Chapter 9 “Nutrient loads and sources”.

•	Industrial operational discharges and intakes: these inputs were set according to the BMT development (Gunaratne et al., 2023) assuming a constant rate and water quality for each input. More details of linkage between the groundwater inputs and CSIEM are provided in Chapter 9 “Nutrient loads and sources”.


![](./media/model/image3.png){width="95%"}

**Figure 4.2.** Overview of the CSIEM model integration ecosystem, depicting the links of the main hydrodynamic-water quality with other dependent model and data products that are required to run an integrated simulation.

## Benthic (bottom) zonation

The CSIEM platform has been designed to accommodate horizontal variation in benthic substrates. This is needed to be able to resolve:
•	the effect of bottom roughness on flow dynamics 
•	the variation of sediment properties, as relevant to sediment transport dynamics
•	the dynamics of bottom biotic communities, and their associated feedbacks to water column properties
•	variability in the dynamics of sediment biogeochemical processes.
Bottom properties are configured via setting of a) material zones and b) relevant benthic or sediment properties. This is done via loading shape files, and/or cell-specific properties into the model configuration. 

The default CSIEM benthic substrate (material zone) map has been made by combining a range of sediment and biotic data-sets. Since the available sediment physical and benthic habitat mapping is focused around the main Cockburn Sound area, and incomplete or not available from other areas, a synthesised product was made for the purposes of configuring a CSIEM simulation. Datasets considered include:
•	Skene et al. (2005) : interpolated sediment size data from within CS
•	WC Bioregion survey : broadscale benthic habitat mapping product
•	WWMSP Theme 2.1 CSOA data product : recent benthic mapping as reported in Hovey et al. (2024)
The benthic model is able to support layering such that default properties can be specified broadly across the domain, and where more accurate mapping data is available (i.e., within the main Cockburn Sound area) then these layers will supersede the defaults.  The layering adopted in this model is shown in Figure 2.3. Note that the high resolution mapping of benthic habitats from the Hovey et al., 2024 data-set is smoothed, to simply the complexity of the shapefile for alignment with the TUFLOW-FV mesh resolution. 
Depending on the mesh adopted, the layer information is translated to cell resolution accordingly, for example, as shown in Figure 2.4 for the three main types. 


![](./media/model/image5.png){width="95%"}

**Figure 4.3.** CSIEM model domain and material zone settings. Left: whole model domain; Right: zoom-in view of Cockburn Sound.


![](./media/model/image6.png){width="95%"}

**Figure 4.4.** Plan-view of CSIEM model benthic material types around the Cockburn Sound region in A (coarse), B (optimized), C (fine) options.


## Model repository and version management

### **Simulation naming and organization**

All model files that are developed within the WAMSI Westport Research program are stored in the `csiem-model` repository, and the model files are classified with project names and model generation identifiers as the model is developed over time. The naming of model folders follows the convention of `{Agency Code}_{Program Code}_{Model Code}_{Model Version}_{Model Period}`, where the 'Agency Code' includes the organizations of:

- `WaterCorp`: model files used for assessing PSDP by the Water Corporation;
- `Westport`: model files developed for assessing Westport Phase 1 scenarios; and
- `WAMSI`: the core CSIEM model files being updated throughout the WAMSI Westport integration project.

The other identifier fields are optional and will be included whereas available. **'Program Code'** indicates which research program the model was deveoped for; **'Model Code'** indicate which model was being used, **'Model Version'** indicates the version through model development, and **'Model Period'** indicates the time of simulations. For example, the model folder `WAMSI_wwmsp_tfvaed_gen0_2021_2022` contains the preliminary version of model files developed for WAMSI WWMSP program using the TUFLOW-fv-AED model, focusing on the time 2021-2022.

As an example, the following models are existing or under development and operational within the `csiem-model` repository:

- `WaterCorp_psdp2_tfvaed`: previous BMT model files for assessing Perth Seawater Desalination Plant 2, for multiple periods;
- `WestPort_breakwater_swan_2011_2020`: BMT SWAN wave simulation for WestPort;
- `WAMSI_wwmsp_wwm_gen1_2011_2021`: WAMSI PROJECT 5.2 wave simulation for Cockburn Sound;
- `WAMSI_wwmsp_tfvaed_gen0_2021_2022`: preliminary version of model files developed for WAMSI WWMSP program using the TUFLOW-fv-AED model, focusing on the time 2021-2022;
- `WAMSI_wwmsp_tfvaed_gen1_2021_2022`: BMT Cycle 1 model files for WAMSI WWMSP program;

Each model folder may contain multiple simulation sets, but they will all rely on the same model base configuration, with minor differences or adujstments. Major changes to a model's configuration will constitute a change in generation numeber and these are stored in a separate folder. Note, models uploaded to the CSIEM repository may have been created by different agencies and researchers and should maintain a consistent naming convention.

Beside the models developed within the WAMSI Westport Research program, there is also a range of environmental models, such as meteorology, wave, hydrodyamics models, that can be used as boundary conditions or reference simulations for Cockburn Sound. These environmental models are outlined in Table \@ref(tab:model-classes1).

<br>

```{r model-classes1, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
library(readxl)
library(rmarkdown)
theSheet <- read_excel('tables/CSIEM_Model_Catalogue_Extract.xlsx', sheet = 1)
theSheet <- theSheet[theSheet$Table == "Data",]
theSheetGroups <- unique(theSheet$Group)

kbl(theSheet[,3:13], caption = "Summary of existing environmental models for West Port. ", align = "l",) %>%
  pack_rows(theSheetGroups[1],
            min(which(theSheet$Group == theSheetGroups[1])),
            max(which(theSheet$Group == theSheetGroups[1])),
            background = '#ebebeb') %>%
  pack_rows(theSheetGroups[2],
            min(which(theSheet$Group == theSheetGroups[2])),
            max(which(theSheet$Group == theSheetGroups[2])),
            background = '#ebebeb') %>%
  pack_rows(theSheetGroups[3],
					  min(which(theSheet$Group == theSheetGroups[3])),
					  max(which(theSheet$Group == theSheetGroups[3])),
					  background = '#ebebeb') %>%
  pack_rows(theSheetGroups[4],
          	min(which(theSheet$Group == theSheetGroups[4])),
          	max(which(theSheet$Group == theSheetGroups[4])),
          	background = '#ebebeb') %>%
  pack_rows(theSheetGroups[5],
          	min(which(theSheet$Group == theSheetGroups[5])),
          	max(which(theSheet$Group == theSheetGroups[5])),
          	background = '#ebebeb') %>%
row_spec(0, background = "#002B4D", bold = TRUE, color = "white") %>%
  kable_styling(full_width = T,font_size = 10) %>%
    scroll_box(fixed_thead = FALSE)

```

### **CSIEM TUFLOW-FV-AED model file organisation**

The TUFLOW-FV-AED model is the main modelling platform of the WWMSP project and contains the following folder structure:

- `BCs`: boundary condition files, including tide and inflow boundary files; meteorological boundary files, and initial condition files;
- `External`: AED model files linked with the TUFLOW-FV, and optionally the ‘GOTM’ vertical mixing model if the CSIEM is in 3D mode;
- `Geo`: TUFLOW-FV model structure files, including geometry and mesh files, and GIS files controlling the nodestrings and material zones;
- `Input`: model control/configuration files;
- `Plotting` : Directory to store model output images;

For WINDOWS users the model folder also contains a `bin` directory containing compatible binaries for the TFV-AED model

- `TFV:` Build version: 2020.03.105
- `AED:` Build version: 2.0.5b

<!---
### **SWAN Wave Model organisation**

The SWAN wave models found in the model directory have the following format:

- `01_geometry` : Contains the bathymetry input files as well as a automatically generated image of the bathymetry and a matlab .mat file containing the bathymetry information;
- `02_bc_dbase` : Contains the processed wind input files
- `03_simulation` : Contains the INPUT control file required to run the simulation
- `04_results` : Model output directory

The script required to create and configure a new SWAN wave model can be found in the `scripts/datatools/wave` directory.

```
--->

